# CythonExample #

[![Build Status](https://travis-ci.org/sandhujasmine/CythonExample.svg?branch=master)](https://travis-ci.org/sandhujasmine/CythonExample)

Example of C++ wrapped by cython and built using setup.py. Create a conda
environment and use conda to install dependencies.

The netcdf4 dependency is built against libcurl.4.dylib (compatibility version 8.0.0,
current version 8.0.0); however, OSX Yosemite's system libraries contains libcurl.4.dylib
(compatibility version 7.0.0, current version 8.0.0)

During building and linking in the conda environment, the environment's libcurl is found.
However, the path to the libcurl to load at runtime is not contained in executable so it tries to load
libcurl from system path and things break.

Added a --post-link option to conda develop, which fixes above problem on Mac OS X. 
It looks in source dir for compiled extensions and ensures they link against libraries
found in conda "env" by embedding the path to the environment's library into the executable.

## Dependencies ##

Using miniconda with python 2.7, cython and pytest. Added netcdf4
to show 

* Python - tested against 2.7
* Cython
* netcdf4   # only used to illustrate above problem
* pytest


## Building in develop mode ##

run setup.py with develop option

```sh
$ ./setup.py develop		# builds in develop mode	
$ ./setup.py cleandev		# cleans autogenerated files during setup
```

Now, we need to correct the linkages in cy_polygon.so

```sh
$ conda develop --post-link polygon
```

run ./polygon/test_polygon.py to test

```sh
$ py.test -v ./polygon/test_polygon.py  # test
```




